pipeline {
    agent any
    tools { 
        maven 'Maven'
    }
    stages {
    	stage ('Initialize') { // hello Jenkins
            steps {
	   	 echo env.GIT_BRANCH
                sh '''
                    echo "Hello from Jenkins"
                ''' 
            }
        }
        stage('Build') {     // build the project ./RiskMeter without runing any test  
        	steps{
    			sh "mvn -DskipTests -f ./RiskMeter package"
    		}
        }
       stage('Test') {
            steps {
                sh 'mvn -f ./RiskMeter test'
            }
	}
        stage('Push') {
            steps {
		    sshagent (credentials: ["121a2089-cb31-4727-9787-f94dc66aaaa1"]){	
		    	//sh " git clean  -d  -f ."
		    	sh " git checkout Patient_branch"
			sh " git pull"
			//sh 'git remote set-url origin https://github.com/$username/$repo.git'
		        //sh 'git config --global user.email "goergedaoud@gmail.com"'
		        //sh 'git config --global user.name "goergedaoud"'
			sh " git add RiskMeter/target/surefire-reports/com.uregina.app.PatientTest.txt"
		        sh " git add RiskMeter/target/surefire-reports/TEST-com.uregina.app.PatientTest.xml"
		        sh " git commit -m 'test results'"
		    	sh " git push origin Patient_branch"
    	      }
	 }
      }
   }
  } 

